{"version":3,"sources":["webpack:///src/app/MyListing/messagesPage/chatPage/chatPage.html","webpack:///src/app/MyListing/messagesPage/messagesPage.html","webpack:///src/app/MyListing/messagesPage/chatPage/chatPage.scss","webpack:///src/app/MyListing/messagesPage/chatPage/chatPage.ts","webpack:///src/app/MyListing/messagesPage/messagesPage.module.ts","webpack:///src/app/MyListing/messagesPage/messagesPage.scss","webpack:///src/app/MyListing/messagesPage/messagesPage.ts"],"names":["ChatPage","service","mlservice","_sanitizer","translate","locationService","navController","router","GlobalFields","msgToSend","loading","loadingMsg","senderMsgSelected","id","getMsgsOfAChat","subscribe","data","msgsSelected","resize","console","log","markAsSeenChat","refresher","setInterval","refreshChat","e","navigateByUrl","clearInterval","obj","res","Object","keys","timestamp","Date","toLocaleString","msg","undefined","content","scrollToTop","setTimeout","sendMsg","err","scroll","selector","template","MessagesPageModule","imports","forChild","path","component","declarations","MessagesPage","loadingChats","search","waitSearch","resultSearchListings","initMsg","showTabs","msgToOwner","isLoggedIn","getMessages","loadingHard","getNewChatsInterval","setWhiteBlackBackgroundStatusBar","getChats","chats","refreshCookie","event","target","complete","user","navigateForward","site_details","themeEnabled","isWhiteBackground","image","bypassSecurityTrustStyle","ev","searchString","value","doIt","key","getMsgUsersByString"],"mappings":"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","file":"MyListing-messagesPage-messagesPage-module-es5.js","sourcesContent":["export default \"\\r\\n<ion-header translucent=\\\"true\\\" dir=\\\"{{GlobalFields.getLanguageLayout()}}\\\">\\r\\n    <ion-toolbar dir=\\\"{{GlobalFields.getLanguageLayout()}}\\\">\\r\\n        <ion-buttons slot=\\\"start\\\">\\r\\n            <ion-back-button defaultHref=\\\"tabs/messages\\\" (click)=\\\"GlobalFields.senderMsgSelected = undefined\\\"></ion-back-button>\\r\\n        </ion-buttons>\\r\\n        <ion-title *ngIf=\\\"GlobalFields.senderMsgSelected\\\" style=\\\"font-size: 9pt;\\\"><img class=\\\"avatarImg\\\"  src=\\\"{{GlobalFields.senderMsgSelected.avatar}}\\\"> {{GlobalFields.senderMsgSelected.name}}</ion-title>\\r\\n    </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n\\r\\n<ion-content *ngIf=\\\"loading\\\" style=\\\" position: fixed; background-color: rgb(0, 0, 0); z-index: 999999; top: 43px !important;\\\">\\r\\n  <div style=\\\"padding: 15px\\\">\\r\\n    <span *ngFor=\\\"let el of [1,2,3,4,5,6]\\\">\\r\\n       <div style=\\\"width: 100%; margin-bottom: 20px; height: 30px; position: relative;\\\">\\r\\n        <ion-skeleton-text style=\\\"width: 40%; position: absolute; left: 0\\\" animated></ion-skeleton-text>\\r\\n      </div>\\r\\n      <div style=\\\"width: 100%; margin-bottom: 20px; height: 30px; position: relative;\\\">\\r\\n        <ion-skeleton-text style=\\\"width: 40%; position: absolute; right: 0\\\" animated></ion-skeleton-text>\\r\\n      </div>\\r\\n    </span>\\r\\n  </div>\\r\\n\\r\\n</ion-content>\\r\\n\\r\\n<ion-content #scrollElement style=\\\"margin-top: 20px; transform: rotate(180deg);\\\"  *ngIf=\\\"GlobalFields.msgsSelected\\\" class=\\\"cards-bg social-cards\\\" [ngStyle]=\\\"GlobalFields.getBodyColorBackgroundJson()\\\"  dir=\\\"{{GlobalFields.getLanguageLayout()}}\\\">\\r\\n\\r\\n    <div id=\\\"msgContainer\\\" style=\\\"transform: rotate(180deg);\\\" *ngIf=\\\"GlobalFields.msgsSelected && GlobalFields.msgsSelected.ml && GlobalFields.senderMsgSelected\\\" >\\r\\n\\r\\n        <ion-row *ngFor=\\\"let key of getKeysOfObj(GlobalFields.msgsSelected.ml)\\\"   dir=\\\"{{GlobalFields.getLanguageLayout()}}\\\">\\r\\n            <ion-col size=\\\"12\\\" style=\\\"padding: 15px; max-width: calc(100% - 60px)\\\"  *ngIf=\\\"GlobalFields.msgsSelected.ml[key]\\\">\\r\\n\\r\\n                <span class=\\\"msgDate\\\" [class.msgMineOther]=\\\"GlobalFields.msgsSelected.ml[key].sender == GlobalFields.senderMsgSelected.id\\\"   dir=\\\"{{GlobalFields.getLanguageLayout()}}\\\">{{getGoodStringDate(GlobalFields.msgsSelected.ml[key].utime * 1000)}}</span>\\r\\n                <p class=\\\"msgMine\\\" *ngIf=\\\"GlobalFields.msgsSelected.ml[key].sender != GlobalFields.senderMsgSelected.id\\\"  [ngStyle]=\\\"GlobalFields.getPrimaryColorBackgroundJson()\\\"   dir=\\\"{{GlobalFields.getLanguageLayout()}}\\\">{{GlobalFields.msgsSelected.ml[key].message}}</p>\\r\\n                <p class=\\\"msgOther\\\" *ngIf=\\\"GlobalFields.msgsSelected.ml[key].sender == GlobalFields.senderMsgSelected.id\\\"   dir=\\\"{{GlobalFields.getLanguageLayout()}}\\\">{{GlobalFields.msgsSelected.ml[key].message}}</p>\\r\\n            </ion-col>\\r\\n        </ion-row>\\r\\n\\r\\n        <p class=\\\"msgMine\\\" *ngIf=\\\"loadingMsg\\\"  [ngStyle]=\\\"GlobalFields.getPrimaryColorBackgroundJson()\\\"   dir=\\\"{{GlobalFields.getLanguageLayout()}}\\\"><i class=\\\"fas fa-spinner fa-spin\\\"></i></p>\\r\\n\\r\\n    </div>\\r\\n\\r\\n\\r\\n  <div style=\\\"transform: rotate(180deg); position: fixed; top: -1px; padding: 10px; padding-bottom:20px; width: 100%; background-color: white\\\">\\r\\n        <textarea id=\\\"myInput\\\" #myInput\\r\\n                  class=\\\"textAreaSend\\\"\\r\\n                  (keyup)=\\\"resize()\\\"\\r\\n                  placeholder=\\\"{{'YOUR_MESSAGE' | translate}}\\\"\\r\\n                  [(ngModel)]=\\\"msgToSend\\\"\\r\\n                  dir=\\\"{{GlobalFields.getLanguageLayout()}}\\\"\\r\\n        ></textarea>\\r\\n    <button class=\\\"btnSend\\\" [ngStyle]=\\\"GlobalFields.getPrimaryColorBackgroundJson()\\\" (click)=\\\"sendMsg()\\\" dir=\\\"{{GlobalFields.getLanguageLayout()}}\\\"><i class=\\\"far fa-paper-plane\\\"></i></button>\\r\\n  </div>\\r\\n\\r\\n  <!--<<div style=\\\"transform: rotate(180deg); position: fixed; box-shadow: 0 -1px 2px rgba(0,0,0,.1); top: -1px; padding: 10px; padding-bottom:20px; width: 100%; background-color: white\\\">\\r\\n     <!-row  dir=\\\"{{GlobalFields.getLanguageLayout()}}\\\">\\r\\n         <ion-col size=\\\"10\\\">\\r\\n             <ion-textarea style=\\\"border: solid 1px #e3e3e3; padding: 5px; border-radius: 5px;\\\"\\r\\n                     id=\\\"myInput\\\" #myInput\\r\\n                     [autoGrow]=\\\"true\\\"\\r\\n                     [autofocus]=\\\"true\\\"\\r\\n                     placeholder=\\\"{{'YOUR_MESSAGE' | translate}}\\\"\\r\\n                     [(ngModel)]=\\\"msgToSend\\\"\\r\\n                     dir=\\\"{{GlobalFields.getLanguageLayout()}}\\\"\\r\\n             >\\r\\n             </ion-textarea>\\r\\n         </ion-col>\\r\\n         <ion-col size=\\\"2\\\">\\r\\n             <button class=\\\"btnSend\\\" [disabled]=\\\"!this.msgToSend\\\" [ngStyle]=\\\"GlobalFields.getPrimaryColorBackgroundJson()\\\" (click)=\\\"sendMsg()\\\" dir=\\\"{{GlobalFields.getLanguageLayout()}}\\\"><i class=\\\"far fa-paper-plane\\\"></i></button>\\r\\n         </ion-col>\\r\\n     </ion-row>\\r\\n\\r\\n    </div>-->\\r\\n</ion-content>\\r\\n\\r\\n\\r\\n\";","export default \"<ion-header translucent=\\\"true\\\" mode=\\\"{{GlobalFields.mode}}\\\" dir=\\\"{{GlobalFields.getLanguageLayout()}}\\\">\\r\\n  <ion-toolbar>\\r\\n    <!-- If Side menu is used-->\\r\\n    <ion-buttons *ngIf=\\\"GlobalFields.site_details.navigationType==2\\\" slot=\\\"start\\\">\\r\\n      <ion-menu-button style=\\\"color: #3b3c3c\\\"></ion-menu-button>\\r\\n    </ion-buttons>\\r\\n    <ion-title>{{'MESSAGES' | translate}}</ion-title>\\r\\n    <ion-buttons *ngIf=\\\"GlobalFields.isLoggedIn\\\" style=\\\"padding-right: 10px;\\\" slot=\\\"end\\\">\\r\\n      <button *ngIf=\\\"!search\\\" class=\\\"btn-search-header\\\" (click)=\\\"search=true\\\">\\r\\n        <i class=\\\"fas fa-edit\\\"></i>\\r\\n      </button>\\r\\n      <button *ngIf=\\\"search\\\" class=\\\"btn-search-header\\\" style=\\\"padding: 8px 10px; color: red\\\" (click)=\\\"search=false; resultSearchListings=undefined\\\">\\r\\n        <i class=\\\"fas fa-times\\\"></i>\\r\\n      </button>    </ion-buttons>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n\\r\\n<!-- Login -->\\r\\n<ion-content *ngIf=\\\"!GlobalFields.isLoggedIn\\\" class=\\\"cards-bg social-cards\\\" style=\\\"margin-top: 20px; padding: 15px\\\"\\r\\n             [ngStyle]=\\\"GlobalFields.getBodyColorBackgroundJson()\\\" dir=\\\"{{GlobalFields.getLanguageLayout()}}\\\">\\r\\n  <!-- [ngStyle]=\\\"GlobalFields.getBodyColorBackgroundJson()\\\"  -->\\r\\n\\r\\n  <ion-header collapse=\\\"condense\\\" dir=\\\"{{GlobalFields.getLanguageLayout()}}\\\">\\r\\n    <ion-toolbar style=\\\"padding: 15px\\\">\\r\\n      <ion-title size=\\\"large\\\">{{'MESSAGES' | translate}}</ion-title>\\r\\n    </ion-toolbar>\\r\\n  </ion-header>\\r\\n  <div class=\\\"pageSection\\\" style=\\\"margin: 15px; margin-top: 20px;\\\">\\r\\n    <loginComponent (loginComplete)=\\\"initMsg()\\\"></loginComponent>\\r\\n  </div>\\r\\n</ion-content>\\r\\n\\r\\n\\r\\n<!-- Msg list-->\\r\\n<ion-content *ngIf=\\\"GlobalFields.isLoggedIn\\\" class=\\\"cards-bg social-cards\\\" style=\\\"margin-top: 10px;\\\"\\r\\n             [ngStyle]=\\\"GlobalFields.getBodyColorBackgroundJson()\\\" dir=\\\"{{GlobalFields.getLanguageLayout()}}\\\">\\r\\n\\r\\n  <ion-header collapse=\\\"condense\\\">\\r\\n    <ion-toolbar style=\\\"padding: 15px\\\">\\r\\n      <ion-title size=\\\"large\\\">{{'MESSAGES' | translate}}</ion-title>\\r\\n    </ion-toolbar>\\r\\n    <ion-toolbar *ngIf=\\\"search\\\">\\r\\n      <ion-searchbar #searchInput placeholder=\\\"{{'START_A_NEW_CHAT' | translate}}\\\" animated showCancelButton=\\\"focus\\\"\\r\\n                     (ionInput)=\\\"searchByName($event);\\\" (ionClear)=\\\"resultSearchListings=[]; search=false\\\"\\r\\n                     (keyup.enter)=\\\"doTheSearch(); search=true\\\"\\r\\n                     (keypress)=\\\"doTheSearch($event); search=true\\\"></ion-searchbar>\\r\\n    </ion-toolbar>\\r\\n  </ion-header>\\r\\n\\r\\n  <!-- Only for android-->\\r\\n  <span class=\\\"hide-ios\\\" *ngIf=\\\"search\\\">\\r\\n        <ion-searchbar #searchInput animated showCancelButton=\\\"focus\\\" (ionInput)=\\\"searchByName($event);\\\"\\r\\n                       (ionClear)=\\\"resultSearchListings=[]; search=false\\\" (keyup.enter)=\\\"doTheSearch(); search=true\\\"\\r\\n                       (keypress)=\\\"doTheSearch($event); search=true\\\"></ion-searchbar>\\r\\n  </span>\\r\\n\\r\\n<!--\\r\\n  <ion-refresher slot=\\\"fixed\\\" (ionRefresh)=\\\"refreshChats($event)\\\">\\r\\n    <ion-refresher-content>\\r\\n    </ion-refresher-content>\\r\\n  </ion-refresher>\\r\\n-->\\r\\n  <!-- Loading animation-->\\r\\n  <div *ngIf=\\\"loadingChats\\\">\\r\\n    <ion-list *ngFor=\\\"let item of [1,2,3,4,5,6,7,8,9,10]\\\">\\r\\n      <ion-item>\\r\\n        <ion-avatar slot=\\\"start\\\">\\r\\n          <ion-skeleton-text animated></ion-skeleton-text>\\r\\n        </ion-avatar>\\r\\n        <ion-label>\\r\\n          <ion-skeleton-text animated style=\\\"width: 50%\\\"></ion-skeleton-text>\\r\\n          <ion-skeleton-text animated style=\\\"width: 80%\\\"></ion-skeleton-text>\\r\\n          <ion-skeleton-text animated style=\\\"width: 60%\\\"></ion-skeleton-text>\\r\\n        </ion-label>\\r\\n      </ion-item>\\r\\n    </ion-list>\\r\\n  </div>\\r\\n\\r\\n  <div *ngIf=\\\"search\\\">\\r\\n    <ion-row *ngFor=\\\"let user of resultSearchListings\\\" style=\\\"line-height: 64px;\\\"\\r\\n             (click)=\\\"getMessages(user); search=false\\\">\\r\\n      <img class=\\\"avatarImg\\\" src=\\\"{{user.avatar}}\\\" style=\\\"margin: 5px; margin-right: 15px;\\\">\\r\\n      {{user.name}}\\r\\n    </ion-row>\\r\\n  </div>\\r\\n\\r\\n  <div style=\\\"width: 100%;\\\" *ngIf=\\\"!loadingChats && chats && !search\\\">\\r\\n    <ion-list>\\r\\n      <ion-item *ngFor=\\\"let chat of chats.chats\\\" (click)=\\\"getMessages(chat.op)\\\" button>\\r\\n     <!-- <ion-item *ngFor=\\\"let key of getKeysOfObj(chats.ml)\\\" (click)=\\\"getMessages(chats.ml[key].op)\\\" button>-->\\r\\n        <ion-avatar slot=\\\"start\\\">\\r\\n          <img src=\\\"{{chat.op.avatar}}\\\">\\r\\n        </ion-avatar>\\r\\n        <ion-label>\\r\\n          <h2 [class]=\\\"'chatName ' +(chat.seen == '0' ? 'newText' : '')\\\">{{chat.op.name}}</h2>\\r\\n          <h3 [class]=\\\"'chatMsg ' +(chat.seen == '0' ? 'newText' : '')\\\">{{chat.message}}</h3>\\r\\n          <p>{{getGoodStringDate(chat.utime * 1000)}}</p>\\r\\n        </ion-label>\\r\\n      </ion-item>\\r\\n    </ion-list>\\r\\n\\r\\n\\r\\n    <!--\\r\\n\\r\\n                <ion-row [className]=\\\"'rowListType ' + isWhiteBackgroundBoxShadow()\\\" >\\r\\n                    <ion-col size=\\\"2\\\" style=\\\"padding: 0 !important; text-align: center; margin-top: 8px;\\\" *ngIf=\\\"chats.ml[key]\\\">\\r\\n                        <img  [class]=\\\"'avatarImg ' +(chats.ml[key].seen == '0' ? 'newImg' : '')\\\"  src=\\\"{{chats.ml[key].op.avatar}}\\\">\\r\\n                    </ion-col>\\r\\n                    <ion-col size=\\\"10\\\" style=\\\"padding: 15px; max-width: calc(100% - 60px)\\\"  *ngIf=\\\"chats.ml[key]\\\">\\r\\n                        <div style=\\\"text-align: left;\\\">\\r\\n                            <div [class]=\\\"'chatName ' +(chats.ml[key].seen == '0' ? 'newText' : '')\\\">{{chats.ml[key].op.name}}</div>\\r\\n                            <div [class]=\\\"'chatMsg ' +(chats.ml[key].seen == '0' ? 'newText' : '')\\\">{{chats.ml[key].message}}</div>\\r\\n                            <div class=\\\"chatTime\\\">\\r\\n                                {{getGoodStringDate(chats.ml[key].utime * 1000)}}\\r\\n                            </div>\\r\\n                        </div>\\r\\n                    </ion-col>\\r\\n                </ion-row>-->\\r\\n  </div>\\r\\n\\r\\n\\r\\n</ion-content>\\r\\n\\r\\n\";","export default \".textAreaSend {\\n  float: left;\\n  width: calc(100% - 50px);\\n  background: transparent !important;\\n  border: solid 1px #dedede !important;\\n  padding: 10px;\\n  font-size: 16px;\\n  color: #242429;\\n  min-height: 35px;\\n  line-height: 1.2;\\n  height: 35px;\\n  box-shadow: none !important;\\n  transition: 0.2s ease;\\n  border-radius: 15px;\\n  font-size: 15px;\\n}\\n\\n.textAreaSend[dir=rtl] {\\n  float: right;\\n}\\n\\n.avatarImg {\\n  width: 30px;\\n  height: 30px;\\n  min-height: 30px;\\n  min-width: 30px;\\n  border-radius: 50%;\\n  margin-right: 5px;\\n}\\n\\n.btnSend {\\n  background: #6c1cff;\\n  color: #fff;\\n  border: #ffdead;\\n  border-radius: 50px;\\n  height: 40px;\\n  width: 40px;\\n  float: right;\\n  outline: none !important;\\n  transition: 0.2s ease;\\n  display: flex;\\n  align-items: center;\\n  font-size: 14pt;\\n  padding-left: 9px;\\n}\\n\\n.btnSend[dir=rtl] {\\n  float: left;\\n  padding-left: 0px;\\n  padding-right: 12px;\\n}\\n\\n.btnSend:disabled {\\n  opacity: 0.4;\\n}\\n\\n.msgMine {\\n  float: right;\\n  background: #6c1cff;\\n  color: #fff;\\n  border-radius: 10px 0 10px 10px;\\n  word-break: break-word;\\n  overflow: hidden;\\n  margin: 0;\\n  padding: 9px 15px;\\n  font-size: 15px;\\n  line-height: 22px !important;\\n}\\n\\n.msgMine[dir=rtl] {\\n  float: left;\\n}\\n\\n.msgOther {\\n  float: left;\\n  background: rgba(189, 189, 189, 0.21);\\n  color: #242429;\\n  border-radius: 0 10px 10px 10px;\\n  word-break: break-word;\\n  overflow: hidden;\\n  margin: 0;\\n  padding: 9px 15px;\\n  font-size: 15px;\\n  line-height: 22px !important;\\n}\\n\\n.msgOther[dir=rtl] {\\n  float: right;\\n}\\n\\n.msgDate {\\n  font-size: 8px;\\n  display: block;\\n  margin-bottom: 5px;\\n  color: #7e7e89;\\n  text-align: right;\\n}\\n\\n.msgDate[dir=rtl] {\\n  text-align: left;\\n}\\n\\n.msgMineOther {\\n  text-align: left !important;\\n}\\n\\n#msgContainer {\\n  width: 100%;\\n  padding: 15px;\\n  padding-bottom: 35px;\\n  margin-top: 115px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvTXlMaXN0aW5nL21lc3NhZ2VzUGFnZS9jaGF0UGFnZS9DOlxcam9rZXNvbmpvZWxcXGpva2Vzb25qb2VsL3NyY1xcYXBwXFxNeUxpc3RpbmdcXG1lc3NhZ2VzUGFnZVxcY2hhdFBhZ2VcXGNoYXRQYWdlLnNjc3MiLCJzcmMvYXBwL015TGlzdGluZy9tZXNzYWdlc1BhZ2UvY2hhdFBhZ2UvY2hhdFBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFdBQUE7RUFDQSx3QkFBQTtFQUNBLGtDQUFBO0VBQ0Esb0NBQUE7RUFDQSxhQUFBO0VBQ0EsZUFBQTtFQUNBLGNBQUE7RUFDQSxnQkFBQTtFQUNBLGdCQUFBO0VBQ0EsWUFBQTtFQUNBLDJCQUFBO0VBQ0EscUJBQUE7RUFDQSxtQkFBQTtFQUNBLGVBQUE7QUNDRjs7QURFQTtFQUNFLFlBQUE7QUNDRjs7QURHQTtFQUNFLFdBQUE7RUFDQSxZQUFBO0VBQ0EsZ0JBQUE7RUFDQSxlQUFBO0VBQ0Esa0JBQUE7RUFDQSxpQkFBQTtBQ0FGOztBREdBO0VBQ0UsbUJBQUE7RUFDQSxXQUFBO0VBQ0EsZUFBQTtFQUNBLG1CQUFBO0VBQ0EsWUFBQTtFQUNBLFdBQUE7RUFDQSxZQUFBO0VBQ0Esd0JBQUE7RUFDQSxxQkFBQTtFQUNBLGFBQUE7RUFDQSxtQkFBQTtFQUNBLGVBQUE7RUFDQSxpQkFBQTtBQ0FGOztBRElBO0VBQ0UsV0FBQTtFQUNBLGlCQUFBO0VBQ0EsbUJBQUE7QUNERjs7QURLQTtFQUNFLFlBQUE7QUNGRjs7QURLQTtFQUNFLFlBQUE7RUFDQSxtQkFBQTtFQUNBLFdBQUE7RUFDQSwrQkFBQTtFQUNBLHNCQUFBO0VBQ0EsZ0JBQUE7RUFDQSxTQUFBO0VBQ0EsaUJBQUE7RUFDQSxlQUFBO0VBQ0EsNEJBQUE7QUNGRjs7QURLQTtFQUNFLFdBQUE7QUNGRjs7QURLQTtFQUNFLFdBQUE7RUFDQSxxQ0FBQTtFQUNBLGNBQUE7RUFDQSwrQkFBQTtFQUNBLHNCQUFBO0VBQ0EsZ0JBQUE7RUFDQSxTQUFBO0VBQ0EsaUJBQUE7RUFDQSxlQUFBO0VBQ0EsNEJBQUE7QUNGRjs7QURLQTtFQUNFLFlBQUE7QUNGRjs7QURLQTtFQUNFLGNBQUE7RUFDQSxjQUFBO0VBQ0Esa0JBQUE7RUFDQSxjQUFBO0VBQ0EsaUJBQUE7QUNGRjs7QURLQTtFQUNFLGdCQUFBO0FDRkY7O0FES0E7RUFDRSwyQkFBQTtBQ0ZGOztBREtBO0VBQ0UsV0FBQTtFQUNBLGFBQUE7RUFDQSxvQkFBQTtFQUNBLGlCQUFBO0FDRkYiLCJmaWxlIjoic3JjL2FwcC9NeUxpc3RpbmcvbWVzc2FnZXNQYWdlL2NoYXRQYWdlL2NoYXRQYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIudGV4dEFyZWFTZW5ke1xyXG4gIGZsb2F0OiBsZWZ0O1xyXG4gIHdpZHRoOiBjYWxjKDEwMCUgLSA1MHB4KTtcclxuICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudCAhaW1wb3J0YW50O1xyXG4gIGJvcmRlcjogc29saWQgMXB4ICNkZWRlZGUgIWltcG9ydGFudDtcclxuICBwYWRkaW5nOiAxMHB4O1xyXG4gIGZvbnQtc2l6ZTogMTZweDtcclxuICBjb2xvcjogIzI0MjQyOTtcclxuICBtaW4taGVpZ2h0OiAzNXB4O1xyXG4gIGxpbmUtaGVpZ2h0OiAxLjI7XHJcbiAgaGVpZ2h0OiAzNXB4O1xyXG4gIGJveC1zaGFkb3c6IG5vbmUgIWltcG9ydGFudDtcclxuICB0cmFuc2l0aW9uOiAwLjJzIGVhc2U7XHJcbiAgYm9yZGVyLXJhZGl1czogMTVweDtcclxuICBmb250LXNpemU6IDE1cHg7XHJcbn1cclxuXHJcbi50ZXh0QXJlYVNlbmRbZGlyPVwicnRsXCJde1xyXG4gIGZsb2F0OiByaWdodDtcclxufVxyXG5cclxuXHJcbi5hdmF0YXJJbWd7XHJcbiAgd2lkdGg6IDMwcHg7XHJcbiAgaGVpZ2h0OiAzMHB4O1xyXG4gIG1pbi1oZWlnaHQ6IDMwcHg7XHJcbiAgbWluLXdpZHRoOiAzMHB4O1xyXG4gIGJvcmRlci1yYWRpdXM6IDUwJTtcclxuICBtYXJnaW4tcmlnaHQ6IDVweDtcclxufVxyXG5cclxuLmJ0blNlbmR7XHJcbiAgYmFja2dyb3VuZDogIzZjMWNmZjtcclxuICBjb2xvcjogI2ZmZjtcclxuICBib3JkZXI6ICNmZmRlYWQ7XHJcbiAgYm9yZGVyLXJhZGl1czogNTBweDtcclxuICBoZWlnaHQ6IDQwcHg7XHJcbiAgd2lkdGg6IDQwcHg7XHJcbiAgZmxvYXQ6IHJpZ2h0O1xyXG4gIG91dGxpbmU6IG5vbmUgIWltcG9ydGFudDtcclxuICB0cmFuc2l0aW9uOiAuMnMgZWFzZTtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbiAgZm9udC1zaXplOiAxNHB0O1xyXG4gIHBhZGRpbmctbGVmdDogOXB4O1xyXG59XHJcblxyXG5cclxuLmJ0blNlbmRbZGlyPVwicnRsXCJde1xyXG4gIGZsb2F0OiBsZWZ0O1xyXG4gIHBhZGRpbmctbGVmdDogMHB4O1xyXG4gIHBhZGRpbmctcmlnaHQ6IDEycHg7XHJcblxyXG59XHJcblxyXG4uYnRuU2VuZDpkaXNhYmxlZHtcclxuICBvcGFjaXR5OiAwLjQ7XHJcbn1cclxuXHJcbi5tc2dNaW5le1xyXG4gIGZsb2F0OiByaWdodDtcclxuICBiYWNrZ3JvdW5kOiAjNmMxY2ZmO1xyXG4gIGNvbG9yOiAjZmZmO1xyXG4gIGJvcmRlci1yYWRpdXM6IDEwcHggMCAxMHB4IDEwcHg7XHJcbiAgd29yZC1icmVhazogYnJlYWstd29yZDtcclxuICBvdmVyZmxvdzogaGlkZGVuO1xyXG4gIG1hcmdpbjogMDtcclxuICBwYWRkaW5nOiA5cHggMTVweDtcclxuICBmb250LXNpemU6IDE1cHg7XHJcbiAgbGluZS1oZWlnaHQ6IDIycHghaW1wb3J0YW50O1xyXG59XHJcblxyXG4ubXNnTWluZVtkaXI9XCJydGxcIl17XHJcbiAgZmxvYXQ6IGxlZnQ7XHJcbn1cclxuXHJcbi5tc2dPdGhlcntcclxuICBmbG9hdDogbGVmdDtcclxuICBiYWNrZ3JvdW5kOiByZ2JhKDE4OSwgMTg5LCAxODksIDAuMjEpO1xyXG4gIGNvbG9yOiAjMjQyNDI5O1xyXG4gIGJvcmRlci1yYWRpdXM6IDAgMTBweCAxMHB4IDEwcHg7XHJcbiAgd29yZC1icmVhazogYnJlYWstd29yZDtcclxuICBvdmVyZmxvdzogaGlkZGVuO1xyXG4gIG1hcmdpbjogMDtcclxuICBwYWRkaW5nOiA5cHggMTVweDtcclxuICBmb250LXNpemU6IDE1cHg7XHJcbiAgbGluZS1oZWlnaHQ6IDIycHghaW1wb3J0YW50O1xyXG59XHJcblxyXG4ubXNnT3RoZXJbZGlyPVwicnRsXCJde1xyXG4gIGZsb2F0OiByaWdodDtcclxufVxyXG5cclxuLm1zZ0RhdGV7XHJcbiAgZm9udC1zaXplOiA4cHg7XHJcbiAgZGlzcGxheTogYmxvY2s7XHJcbiAgbWFyZ2luLWJvdHRvbTogNXB4O1xyXG4gIGNvbG9yOiAjN2U3ZTg5O1xyXG4gIHRleHQtYWxpZ246IHJpZ2h0O1xyXG59XHJcblxyXG4ubXNnRGF0ZVtkaXI9XCJydGxcIl17XHJcbiAgdGV4dC1hbGlnbjogbGVmdDtcclxufVxyXG5cclxuLm1zZ01pbmVPdGhlcntcclxuICB0ZXh0LWFsaWduOiBsZWZ0ICFpbXBvcnRhbnQ7XHJcbn1cclxuXHJcbiNtc2dDb250YWluZXJ7XHJcbiAgd2lkdGg6IDEwMCU7XHJcbiAgcGFkZGluZzogMTVweDtcclxuICBwYWRkaW5nLWJvdHRvbTogMzVweDtcclxuICBtYXJnaW4tdG9wOiAxMTVweDtcclxufVxyXG4iLCIudGV4dEFyZWFTZW5kIHtcbiAgZmxvYXQ6IGxlZnQ7XG4gIHdpZHRoOiBjYWxjKDEwMCUgLSA1MHB4KTtcbiAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQgIWltcG9ydGFudDtcbiAgYm9yZGVyOiBzb2xpZCAxcHggI2RlZGVkZSAhaW1wb3J0YW50O1xuICBwYWRkaW5nOiAxMHB4O1xuICBmb250LXNpemU6IDE2cHg7XG4gIGNvbG9yOiAjMjQyNDI5O1xuICBtaW4taGVpZ2h0OiAzNXB4O1xuICBsaW5lLWhlaWdodDogMS4yO1xuICBoZWlnaHQ6IDM1cHg7XG4gIGJveC1zaGFkb3c6IG5vbmUgIWltcG9ydGFudDtcbiAgdHJhbnNpdGlvbjogMC4ycyBlYXNlO1xuICBib3JkZXItcmFkaXVzOiAxNXB4O1xuICBmb250LXNpemU6IDE1cHg7XG59XG5cbi50ZXh0QXJlYVNlbmRbZGlyPXJ0bF0ge1xuICBmbG9hdDogcmlnaHQ7XG59XG5cbi5hdmF0YXJJbWcge1xuICB3aWR0aDogMzBweDtcbiAgaGVpZ2h0OiAzMHB4O1xuICBtaW4taGVpZ2h0OiAzMHB4O1xuICBtaW4td2lkdGg6IDMwcHg7XG4gIGJvcmRlci1yYWRpdXM6IDUwJTtcbiAgbWFyZ2luLXJpZ2h0OiA1cHg7XG59XG5cbi5idG5TZW5kIHtcbiAgYmFja2dyb3VuZDogIzZjMWNmZjtcbiAgY29sb3I6ICNmZmY7XG4gIGJvcmRlcjogI2ZmZGVhZDtcbiAgYm9yZGVyLXJhZGl1czogNTBweDtcbiAgaGVpZ2h0OiA0MHB4O1xuICB3aWR0aDogNDBweDtcbiAgZmxvYXQ6IHJpZ2h0O1xuICBvdXRsaW5lOiBub25lICFpbXBvcnRhbnQ7XG4gIHRyYW5zaXRpb246IDAuMnMgZWFzZTtcbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgZm9udC1zaXplOiAxNHB0O1xuICBwYWRkaW5nLWxlZnQ6IDlweDtcbn1cblxuLmJ0blNlbmRbZGlyPXJ0bF0ge1xuICBmbG9hdDogbGVmdDtcbiAgcGFkZGluZy1sZWZ0OiAwcHg7XG4gIHBhZGRpbmctcmlnaHQ6IDEycHg7XG59XG5cbi5idG5TZW5kOmRpc2FibGVkIHtcbiAgb3BhY2l0eTogMC40O1xufVxuXG4ubXNnTWluZSB7XG4gIGZsb2F0OiByaWdodDtcbiAgYmFja2dyb3VuZDogIzZjMWNmZjtcbiAgY29sb3I6ICNmZmY7XG4gIGJvcmRlci1yYWRpdXM6IDEwcHggMCAxMHB4IDEwcHg7XG4gIHdvcmQtYnJlYWs6IGJyZWFrLXdvcmQ7XG4gIG92ZXJmbG93OiBoaWRkZW47XG4gIG1hcmdpbjogMDtcbiAgcGFkZGluZzogOXB4IDE1cHg7XG4gIGZvbnQtc2l6ZTogMTVweDtcbiAgbGluZS1oZWlnaHQ6IDIycHggIWltcG9ydGFudDtcbn1cblxuLm1zZ01pbmVbZGlyPXJ0bF0ge1xuICBmbG9hdDogbGVmdDtcbn1cblxuLm1zZ090aGVyIHtcbiAgZmxvYXQ6IGxlZnQ7XG4gIGJhY2tncm91bmQ6IHJnYmEoMTg5LCAxODksIDE4OSwgMC4yMSk7XG4gIGNvbG9yOiAjMjQyNDI5O1xuICBib3JkZXItcmFkaXVzOiAwIDEwcHggMTBweCAxMHB4O1xuICB3b3JkLWJyZWFrOiBicmVhay13b3JkO1xuICBvdmVyZmxvdzogaGlkZGVuO1xuICBtYXJnaW46IDA7XG4gIHBhZGRpbmc6IDlweCAxNXB4O1xuICBmb250LXNpemU6IDE1cHg7XG4gIGxpbmUtaGVpZ2h0OiAyMnB4ICFpbXBvcnRhbnQ7XG59XG5cbi5tc2dPdGhlcltkaXI9cnRsXSB7XG4gIGZsb2F0OiByaWdodDtcbn1cblxuLm1zZ0RhdGUge1xuICBmb250LXNpemU6IDhweDtcbiAgZGlzcGxheTogYmxvY2s7XG4gIG1hcmdpbi1ib3R0b206IDVweDtcbiAgY29sb3I6ICM3ZTdlODk7XG4gIHRleHQtYWxpZ246IHJpZ2h0O1xufVxuXG4ubXNnRGF0ZVtkaXI9cnRsXSB7XG4gIHRleHQtYWxpZ246IGxlZnQ7XG59XG5cbi5tc2dNaW5lT3RoZXIge1xuICB0ZXh0LWFsaWduOiBsZWZ0ICFpbXBvcnRhbnQ7XG59XG5cbiNtc2dDb250YWluZXIge1xuICB3aWR0aDogMTAwJTtcbiAgcGFkZGluZzogMTVweDtcbiAgcGFkZGluZy1ib3R0b206IDM1cHg7XG4gIG1hcmdpbi10b3A6IDExNXB4O1xufSJdfQ== */\";","import {Component, ElementRef, ViewChild} from '@angular/core';\r\nimport {Chat} from '../../../entities/Chat';\r\nimport {Service} from '../../../services/Service';\r\nimport {DomSanitizer} from '@angular/platform-browser';\r\nimport {TranslateService} from '@ngx-translate/core';\r\nimport {LocationService} from '../../../services/LocationService';\r\nimport {IonContent, NavController} from '@ionic/angular';\r\nimport {GlobalFields} from '../../../GlobalFields';\r\nimport {Router} from '@angular/router';\r\nimport {MyListingService} from '../../../services/MyListingService';\r\n\r\n\r\n@Component({\r\n  selector: 'chatPage',\r\n  templateUrl: 'chatPage.html',\r\n  styleUrls: ['chatPage.scss']\r\n\r\n})\r\nexport class ChatPage {\r\n  @ViewChild('scrollElement') content: IonContent;\r\n\r\n\r\n  GlobalFields = GlobalFields;\r\n\r\n  msgsSelected: Chat;\r\n\r\n  msgToSend = '';\r\n\r\n  loading = true;\r\n  loadingMsg = false;\r\n\r\n  refresher;\r\n\r\n  constructor(public service: Service, public mlservice: MyListingService, private _sanitizer: DomSanitizer, public translate: TranslateService,\r\n              private locationService: LocationService, private navController: NavController, private router: Router) {\r\n\r\n  }\r\n\r\n\r\n  ionViewDidEnter() {\r\n\r\n    if (this.GlobalFields.senderMsgSelected && this.GlobalFields.senderMsgSelected.id) {\r\n      this.mlservice.getMsgsOfAChat(this.GlobalFields.senderMsgSelected.id).subscribe((data: any) => {\r\n        this.GlobalFields.msgsSelected = data;\r\n        this.loading = false;\r\n        this.resize();\r\n        // this.content.scrollToBottom();\r\n\r\n        if (GlobalFields.senderMsgSelected)\r\n          console.log('Mark as seen');\r\n        this.mlservice.markAsSeenChat(GlobalFields.senderMsgSelected.id).subscribe((data: any) => {\r\n        });\r\n\r\n        this.refresher = setInterval(() => {\r\n          this.refreshChat();\r\n        }, 2000);\r\n      }, e => {\r\n        this.router.navigateByUrl('tabs/messages');\r\n      });\r\n    } else\r\n      this.router.navigateByUrl('tabs/messages');\r\n  }\r\n\r\n  ionViewWillLeave() {\r\n    // this.GlobalFields.msgsSelected = undefined;\r\n    clearInterval(this.refresher);\r\n  }\r\n\r\n  getKeysOfObj(obj) {\r\n    const res = Object.keys(obj);\r\n    if (!res)\r\n      return [];\r\n    return res;\r\n  }\r\n\r\n  resize() {\r\n    /*const input = document.getElementById('myInput');\r\n    const container = document.getElementById('msgContainer');\r\n    if (input && container) {\r\n        let newHeight = input.scrollHeight > (window.innerHeight / 2) ? Math.round(window.innerHeight / 2) : input.scrollHeight;\r\n        if (!this.msgToSend || this.msgToSend == \"\")\r\n            newHeight = 35;\r\n        //input.style.height = (newHeight) + 'px';\r\n        container.style.marginBottom = (newHeight + 50) + 'px';\r\n        container.scrollTop = container.scrollHeight;\r\n    }\r\n    this.content.scrollToBottom();\r\n   */\r\n  }\r\n\r\n  getGoodStringDate(timestamp: number) {\r\n    return new Date(timestamp).toLocaleString();\r\n  }\r\n\r\n  sendMsg() {\r\n\r\n\r\n    const msg = this.msgToSend;\r\n    this.msgToSend = undefined;\r\n\r\n    this.loadingMsg = true;\r\n    //this.content.scrollToBottom();\r\n    this.content.scrollToTop();\r\n    setTimeout(() => {\r\n      this.resize();\r\n      //this.content.scrollToBottom();\r\n      this.content.scrollToTop();\r\n    }, 100);\r\n\r\n    if (msg) {\r\n      this.mlservice.sendMsg(msg, GlobalFields.senderMsgSelected.id).subscribe(() => {\r\n        this.loadingMsg = false;\r\n        this.refreshChat(true);\r\n      }), err => {\r\n        console.log(err);\r\n        this.msgToSend = msg;\r\n        this.loadingMsg = false;\r\n      };\r\n    }\r\n\r\n  }\r\n\r\n\r\n  refreshChat(scroll?: boolean) {\r\n    console.log('RefreshChat');\r\n    if (GlobalFields.senderMsgSelected)\r\n      this.mlservice.getMsgsOfAChat(GlobalFields.senderMsgSelected.id).subscribe((data: any) => {\r\n        this.GlobalFields.msgsSelected = data;\r\n        if (scroll) {\r\n          setTimeout(() => {\r\n            this.resize();\r\n            // this.content.scrollToBottom();\r\n          }, 500);\r\n\r\n        }\r\n      });\r\n  }\r\n}\r\n","import { CommonModule } from '@angular/common';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { RouterModule } from '@angular/router';\r\n\r\nimport {NgModule} from \"@angular/core\";\r\nimport {SharedModule} from '../../shared.module';\r\nimport {MessagesPage} from './messagesPage';\r\nimport {ChatPage} from './chatPage/chatPage';\r\nimport {LoginComponentModule} from '../../menuPage/loginComponent/loginComponent.module';\r\n\r\n@NgModule({\r\n    imports: [\r\n        CommonModule,\r\n        FormsModule,\r\n        IonicModule,\r\n        SharedModule,\r\n        RouterModule.forChild([\r\n            {\r\n                path: '',\r\n                component: MessagesPage\r\n            },\r\n            {\r\n                path: 'chatPage',\r\n                component: ChatPage\r\n            }\r\n        ]),\r\n        LoginComponentModule\r\n    ],\r\n    declarations: [MessagesPage, ChatPage]\r\n})\r\nexport class MessagesPageModule {}\r\n","export default \".boxShadowList {\\n  box-shadow: 0 3px 6px 0 rgba(0, 0, 0, 0.1);\\n}\\n\\n.rowListType {\\n  background: white;\\n  margin-bottom: 10px;\\n  border-radius: 5px;\\n  padding: 0 5px 0 5px;\\n}\\n\\n.avatarImg {\\n  width: 54px;\\n  height: 54px;\\n  min-height: 54px;\\n  min-width: 54px;\\n  border-radius: 50%;\\n}\\n\\n.newImg {\\n  border: 2px solid #f24286;\\n  padding: 2px;\\n  width: 56px !important;\\n  height: 56px !important;\\n  min-height: 56px !important;\\n  min-width: 56px !important;\\n}\\n\\n.newText {\\n  color: #242429 !important;\\n  font-weight: 600 !important;\\n}\\n\\n.chatName {\\n  color: #242429;\\n  font-weight: 600;\\n  font-size: 11pt;\\n  white-space: nowrap;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n  text-transform: capitalize;\\n  max-width: calc(100% - 20px);\\n}\\n\\n.chatMsg {\\n  font-size: 9pt;\\n  line-height: 17px;\\n  margin-top: 5px;\\n  white-space: nowrap;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n  text-transform: capitalize;\\n  margin-bottom: 0;\\n  color: #7e7e89;\\n  max-width: calc(100% - 20px);\\n}\\n\\n.chatTime {\\n  position: absolute;\\n  right: 0px;\\n  text-align: right;\\n  top: 0;\\n  height: 100%;\\n  padding: 9px 0px 15px 80px;\\n  font-size: 9px;\\n  color: #7e7e89;\\n  display: grid;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvTXlMaXN0aW5nL21lc3NhZ2VzUGFnZS9DOlxcam9rZXNvbmpvZWxcXGpva2Vzb25qb2VsL3NyY1xcYXBwXFxNeUxpc3RpbmdcXG1lc3NhZ2VzUGFnZVxcbWVzc2FnZXNQYWdlLnNjc3MiLCJzcmMvYXBwL015TGlzdGluZy9tZXNzYWdlc1BhZ2UvbWVzc2FnZXNQYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0E7RUFFRSwwQ0FBQTtBQ0FGOztBRElBO0VBQ0UsaUJBQUE7RUFDQSxtQkFBQTtFQUNBLGtCQUFBO0VBQ0Esb0JBQUE7QUNERjs7QURJQTtFQUNFLFdBQUE7RUFDQSxZQUFBO0VBQ0EsZ0JBQUE7RUFDQSxlQUFBO0VBQ0Esa0JBQUE7QUNERjs7QURJQTtFQUNFLHlCQUFBO0VBQ0EsWUFBQTtFQUNBLHNCQUFBO0VBQ0EsdUJBQUE7RUFDQSwyQkFBQTtFQUNBLDBCQUFBO0FDREY7O0FESUE7RUFDRSx5QkFBQTtFQUNBLDJCQUFBO0FDREY7O0FESUE7RUFDRSxjQUFBO0VBQ0EsZ0JBQUE7RUFDQSxlQUFBO0VBQ0EsbUJBQUE7RUFDQSxnQkFBQTtFQUNBLHVCQUFBO0VBQ0EsMEJBQUE7RUFDQSw0QkFBQTtBQ0RGOztBRElBO0VBQ0UsY0FBQTtFQUNBLGlCQUFBO0VBQ0EsZUFBQTtFQUNBLG1CQUFBO0VBQ0EsZ0JBQUE7RUFDQSx1QkFBQTtFQUNBLDBCQUFBO0VBQ0EsZ0JBQUE7RUFDQSxjQUFBO0VBQ0EsNEJBQUE7QUNERjs7QURJQTtFQUNFLGtCQUFBO0VBQ0EsVUFBQTtFQUNBLGlCQUFBO0VBQ0EsTUFBQTtFQUNBLFlBQUE7RUFDQSwwQkFBQTtFQUNBLGNBQUE7RUFDQSxjQUFBO0VBQ0EsYUFBQTtBQ0RGIiwiZmlsZSI6InNyYy9hcHAvTXlMaXN0aW5nL21lc3NhZ2VzUGFnZS9tZXNzYWdlc1BhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIlxyXG4uYm94U2hhZG93TGlzdHtcclxuICAtd2Via2l0LWJveC1zaGFkb3c6IDAgM3B4IDZweCAwIHJnYmEoMCwwLDAsLjEpO1xyXG4gIGJveC1zaGFkb3c6IDAgM3B4IDZweCAwIHJnYmEoMCwwLDAsLjEpO1xyXG59XHJcblxyXG5cclxuLnJvd0xpc3RUeXBle1xyXG4gIGJhY2tncm91bmQ6IHdoaXRlO1xyXG4gIG1hcmdpbi1ib3R0b206IDEwcHg7XHJcbiAgYm9yZGVyLXJhZGl1czogNXB4O1xyXG4gIHBhZGRpbmc6IDAgNXB4IDAgNXB4O1xyXG59XHJcblxyXG4uYXZhdGFySW1ne1xyXG4gIHdpZHRoOiA1NHB4O1xyXG4gIGhlaWdodDogNTRweDtcclxuICBtaW4taGVpZ2h0OiA1NHB4O1xyXG4gIG1pbi13aWR0aDogNTRweDtcclxuICBib3JkZXItcmFkaXVzOiA1MCU7XHJcbn1cclxuXHJcbi5uZXdJbWd7XHJcbiAgYm9yZGVyOiAycHggc29saWQgI2YyNDI4NjtcclxuICBwYWRkaW5nOiAycHg7XHJcbiAgd2lkdGg6IDU2cHggIWltcG9ydGFudDtcclxuICBoZWlnaHQ6IDU2cHggIWltcG9ydGFudDtcclxuICBtaW4taGVpZ2h0OiA1NnB4ICFpbXBvcnRhbnQ7XHJcbiAgbWluLXdpZHRoOiA1NnB4ICFpbXBvcnRhbnQ7XHJcbn1cclxuXHJcbi5uZXdUZXh0e1xyXG4gIGNvbG9yOiAjMjQyNDI5IWltcG9ydGFudDtcclxuICBmb250LXdlaWdodDogNjAwIWltcG9ydGFudDtcclxufVxyXG5cclxuLmNoYXROYW1le1xyXG4gIGNvbG9yOiAjMjQyNDI5O1xyXG4gIGZvbnQtd2VpZ2h0OiA2MDA7XHJcbiAgZm9udC1zaXplOiAxMXB0O1xyXG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XHJcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcclxuICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcztcclxuICB0ZXh0LXRyYW5zZm9ybTogY2FwaXRhbGl6ZTtcclxuICBtYXgtd2lkdGg6IGNhbGMoMTAwJSAtIDIwcHgpO1xyXG59XHJcblxyXG4uY2hhdE1zZ3tcclxuICBmb250LXNpemU6IDlwdDtcclxuICBsaW5lLWhlaWdodDogMTdweDtcclxuICBtYXJnaW4tdG9wOiA1cHg7XHJcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcclxuICBvdmVyZmxvdzogaGlkZGVuO1xyXG4gIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzO1xyXG4gIHRleHQtdHJhbnNmb3JtOiBjYXBpdGFsaXplO1xyXG4gIG1hcmdpbi1ib3R0b206IDA7XHJcbiAgY29sb3I6ICM3ZTdlODk7XHJcbiAgbWF4LXdpZHRoOiBjYWxjKDEwMCUgLSAyMHB4KTtcclxufVxyXG5cclxuLmNoYXRUaW1le1xyXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICByaWdodDogMHB4O1xyXG4gIHRleHQtYWxpZ246IHJpZ2h0O1xyXG4gIHRvcDogMDtcclxuICBoZWlnaHQ6IDEwMCU7XHJcbiAgcGFkZGluZzogOXB4IDBweCAxNXB4IDgwcHg7XHJcbiAgZm9udC1zaXplOiA5cHg7XHJcbiAgY29sb3I6ICM3ZTdlODk7XHJcbiAgZGlzcGxheTogZ3JpZDtcclxufVxyXG4iLCIuYm94U2hhZG93TGlzdCB7XG4gIC13ZWJraXQtYm94LXNoYWRvdzogMCAzcHggNnB4IDAgcmdiYSgwLCAwLCAwLCAwLjEpO1xuICBib3gtc2hhZG93OiAwIDNweCA2cHggMCByZ2JhKDAsIDAsIDAsIDAuMSk7XG59XG5cbi5yb3dMaXN0VHlwZSB7XG4gIGJhY2tncm91bmQ6IHdoaXRlO1xuICBtYXJnaW4tYm90dG9tOiAxMHB4O1xuICBib3JkZXItcmFkaXVzOiA1cHg7XG4gIHBhZGRpbmc6IDAgNXB4IDAgNXB4O1xufVxuXG4uYXZhdGFySW1nIHtcbiAgd2lkdGg6IDU0cHg7XG4gIGhlaWdodDogNTRweDtcbiAgbWluLWhlaWdodDogNTRweDtcbiAgbWluLXdpZHRoOiA1NHB4O1xuICBib3JkZXItcmFkaXVzOiA1MCU7XG59XG5cbi5uZXdJbWcge1xuICBib3JkZXI6IDJweCBzb2xpZCAjZjI0Mjg2O1xuICBwYWRkaW5nOiAycHg7XG4gIHdpZHRoOiA1NnB4ICFpbXBvcnRhbnQ7XG4gIGhlaWdodDogNTZweCAhaW1wb3J0YW50O1xuICBtaW4taGVpZ2h0OiA1NnB4ICFpbXBvcnRhbnQ7XG4gIG1pbi13aWR0aDogNTZweCAhaW1wb3J0YW50O1xufVxuXG4ubmV3VGV4dCB7XG4gIGNvbG9yOiAjMjQyNDI5ICFpbXBvcnRhbnQ7XG4gIGZvbnQtd2VpZ2h0OiA2MDAgIWltcG9ydGFudDtcbn1cblxuLmNoYXROYW1lIHtcbiAgY29sb3I6ICMyNDI0Mjk7XG4gIGZvbnQtd2VpZ2h0OiA2MDA7XG4gIGZvbnQtc2l6ZTogMTFwdDtcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7XG4gIHRleHQtdHJhbnNmb3JtOiBjYXBpdGFsaXplO1xuICBtYXgtd2lkdGg6IGNhbGMoMTAwJSAtIDIwcHgpO1xufVxuXG4uY2hhdE1zZyB7XG4gIGZvbnQtc2l6ZTogOXB0O1xuICBsaW5lLWhlaWdodDogMTdweDtcbiAgbWFyZ2luLXRvcDogNXB4O1xuICB3aGl0ZS1zcGFjZTogbm93cmFwO1xuICBvdmVyZmxvdzogaGlkZGVuO1xuICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcztcbiAgdGV4dC10cmFuc2Zvcm06IGNhcGl0YWxpemU7XG4gIG1hcmdpbi1ib3R0b206IDA7XG4gIGNvbG9yOiAjN2U3ZTg5O1xuICBtYXgtd2lkdGg6IGNhbGMoMTAwJSAtIDIwcHgpO1xufVxuXG4uY2hhdFRpbWUge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHJpZ2h0OiAwcHg7XG4gIHRleHQtYWxpZ246IHJpZ2h0O1xuICB0b3A6IDA7XG4gIGhlaWdodDogMTAwJTtcbiAgcGFkZGluZzogOXB4IDBweCAxNXB4IDgwcHg7XG4gIGZvbnQtc2l6ZTogOXB4O1xuICBjb2xvcjogIzdlN2U4OTtcbiAgZGlzcGxheTogZ3JpZDtcbn0iXX0= */\";","import {Component, OnInit, ViewChild} from '@angular/core';\r\nimport {NavController, Platform, PopoverController} from '@ionic/angular';\r\nimport {Listing} from '../../entities/myListing/listing';\r\nimport {GlobalFields} from '../../GlobalFields';\r\nimport {StatusBar} from '@ionic-native/status-bar/ngx';\r\n\r\nimport {Service} from '../../services/Service';\r\n\r\n\r\nimport 'hammerjs';\r\nimport {TranslateService} from '@ngx-translate/core';\r\nimport {DomSanitizer} from '@angular/platform-browser';\r\nimport {LocationService} from '../../services/LocationService';\r\nimport {Chat} from '../../entities/Chat';\r\nimport {Profile} from '../../entities/profile';\r\nimport {User} from '../../entities/user';\r\nimport {MyListingService} from '../../services/MyListingService';\r\n\r\n@Component({\r\n  selector: 'messagesPage',\r\n  templateUrl: 'messagesPage.html',\r\n  styleUrls: ['messagesPage.scss']\r\n\r\n})\r\nexport class MessagesPage implements OnInit {\r\n  // @ViewChild('search') searchInput : any;\r\n\r\n  chats: Chat;\r\n\r\n  loadingChats = true;\r\n\r\n  GlobalFields = GlobalFields;\r\n\r\n  msgsSelected: Chat;\r\n\r\n  search = false;\r\n  searchString;\r\n  waitSearch = false;\r\n  resultSearchListings: User[] = [];\r\n\r\n\r\n  msgToOwner: { avatar?: string; id: number, name?: string };\r\n\r\n  refresher;\r\n\r\n  constructor(public service: Service, public mlservice: MyListingService, private _sanitizer: DomSanitizer, public translate: TranslateService,\r\n              private locationService: LocationService, private navController: NavController) {\r\n\r\n\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.initMsg();\r\n  }\r\n\r\n\r\n  ionViewDidEnter() {\r\n    this.GlobalFields.showTabs = true;\r\n\r\n    if (this.GlobalFields.msgToOwner) {\r\n      this.msgToOwner = this.GlobalFields.msgToOwner;\r\n      if (GlobalFields.isLoggedIn)\r\n        this.getMessages(this.msgToOwner);\r\n    }\r\n    this.GlobalFields.msgToOwner = undefined;\r\n    this.GlobalFields.loadingHard = false;\r\n\r\n    //this.GlobalFields.msgsSelected = undefined;\r\n    console.log('ionViewDidEnter');\r\n\r\n    if (this.GlobalFields.isLoggedIn) {\r\n      this.refresher = setInterval(() => {\r\n        this.getNewChatsInterval();\r\n      }, 3000);\r\n    }\r\n\r\n    this.service.setWhiteBlackBackgroundStatusBar();\r\n\r\n  }\r\n\r\n  ionViewWillLeave() {\r\n    clearInterval(this.refresher);\r\n  }\r\n\r\n\r\n  initMsg() {\r\n\r\n    if (this.GlobalFields.isLoggedIn) {\r\n      this.getChats();\r\n      //this.service.getRecentViewedListing();\r\n      if (this.msgToOwner)\r\n        this.getMessages(this.msgToOwner);\r\n    }\r\n  }\r\n\r\n  getChats() {\r\n    this.loadingChats = true;\r\n    this.mlservice.getChats().subscribe((data: any) => {\r\n      this.chats = data;\r\n      this.loadingChats = false;\r\n    }, function (e) {\r\n      this.service.refreshCookie();\r\n    });\r\n  }\r\n\r\n  refreshChats(event) {\r\n    this.loadingChats = true;\r\n    this.mlservice.getChats().subscribe((data: any) => {\r\n      this.chats = data;\r\n      this.loadingChats = false;\r\n      event.target.complete();\r\n    });\r\n  }\r\n\r\n  getNewChatsInterval() {\r\n    console.log('getNewChatsInterval');\r\n    if (this.GlobalFields.isLoggedIn) {\r\n      this.mlservice.getChats().subscribe((data: any) => {\r\n        this.chats = data;\r\n      });\r\n    }\r\n  }\r\n\r\n  getMessages(user?: User) {\r\n    this.msgToOwner = undefined;\r\n    if (user && user.id) {\r\n      //this.GlobalFields.loadingSoft = true;\r\n      this.GlobalFields.senderMsgSelected = user;\r\n      this.GlobalFields.showTabs = false;\r\n      this.navController.navigateForward('tabs/' + GlobalFields.site_details.themeEnabled + '/messages/chatPage');\r\n    }\r\n  }\r\n\r\n  isWhiteBackgroundBoxShadow(): string {\r\n    if (GlobalFields.isWhiteBackground())\r\n      return '';\r\n    else\r\n      return ' boxShadowList';\r\n  }\r\n\r\n  getKeysOfObj(obj) {\r\n    const res = Object.keys(obj);\r\n    if (!res)\r\n      return [];\r\n    return res;\r\n  }\r\n\r\n\r\n  getBackground(image: string) {\r\n    return this._sanitizer.bypassSecurityTrustStyle(`url(${image})`);\r\n  }\r\n\r\n  getGoodStringDate(timestamp: number) {\r\n    return new Date(timestamp).toLocaleString();\r\n  }\r\n\r\n\r\n  searchByName(ev: any) {\r\n    this.searchString = ev.target.value;\r\n  }\r\n\r\n  doTheSearch(event?) {\r\n\r\n    console.log('Enter called');\r\n    console.log(event);\r\n\r\n    let doIt = false;\r\n    if (event && event.key === 'Enter')  // Do stuff}\r\n      doIt = true;\r\n    else if (!event)\r\n      doIt = true;\r\n\r\n    if (doIt) {\r\n      this.resultSearchListings = [];\r\n\r\n      setTimeout(() => {\r\n        this.waitSearch = false;\r\n        this.loadingChats = true;\r\n        if (!this.waitSearch && this.searchString && this.searchString != '') {\r\n          this.mlservice.getMsgUsersByString(this.searchString)\r\n            .subscribe((data: any) => {\r\n              this.resultSearchListings = data;\r\n              this.loadingChats = false;\r\n            });\r\n          this.waitSearch = true;\r\n        }\r\n      }, 500);\r\n    }\r\n  }\r\n\r\n  /*setFocusSearchInput(){\r\n      setTimeout(() => {\r\n          this.searchInput.setFocus();\r\n      }, 500);\r\n  }*/\r\n}\r\n"]}